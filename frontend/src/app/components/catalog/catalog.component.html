<div class="m-3 d-flex gap-3">
  <aside class="filtros">
   
    @if (generoValor.length > 0) {
    <span
      class="badge bg-light text-dark border d-inline-flex align-items-center gap-2 px-3 py-2 mb-3 rounded-pill me-2"
    >
      <span class="tag-busqueda">{{ generoValor }}</span>
      <button
        type="button"
        class="btn-close btn-close-sm"
        (click)="limpiarFiltroGenero()"
        aria-label="Limpiar gÃ©nero"
        style="font-size: 0.7rem"
      ></button>
    </span>
    } @if (precioValor.length > 0) {
    <span
      class="badge bg-light text-dark border d-inline-flex align-items-center gap-2 px-3 py-2 mb-3 rounded-pill"
    >
      <span class="tag-busqueda">{{ precioValor }}</span>
      <button
        type="button"
        class="btn-close btn-close-sm"
        (click)="limpiarFiltroPrecio()"
        aria-label="Limpiar precio"
        style="font-size: 0.7rem"
      ></button>
    </span>
    }

    <p class="titulo-seccion fs-3">Busqueda</p>

    <form [formGroup]="filtros">
      <input
        type="text"
        formControlName="busqueda"
        class="form-control"
        placeholder="Buscar por nombre, autor o formato"
      />

      <div class="my-3">
        <p class="titulo-seccion">Generos</p>
        <hr />

        <ul class="list-group">
          <li
            class="list-group-item"
            [ngClass]="{ active: filtros.get('genero')?.value === 'Fantasia' }"
            (click)="seleccionarGenero('Fantasia')"
          >
            <a href="javascript:void(0)">Fantasia</a>
          </li>
          <li
            class="list-group-item"
            [ngClass]="{ active: filtros.get('genero')?.value === 'Novela' }"
            (click)="seleccionarGenero('Novela')"
          >
            <a href="javascript:void(0)">Novela</a>
          </li>
          <li
            class="list-group-item"
            [ngClass]="{ active: filtros.get('genero')?.value === 'Tecnologia' }"
            (click)="seleccionarGenero('Tecnologia')"
          >
            <a href="javascript:void(0)">Tecnologia</a>
          </li>
          <li
            class="list-group-item"
            [ngClass]="{ active: filtros.get('genero')?.value === 'Policial' }"
            (click)="seleccionarGenero('Policial')"
          >
            <a href="javascript:void(0)">Policial</a>
          </li>
        </ul>
      </div>

      <div class="rango-precio">
        <p class="titulo-seccion">Rango de precios</p>
        <hr />

        <div class="d-flex gap-5 mx-2">
          <div>
            <label for="minimo" class="mb-1">Minimo</label>
            <input
              type="number"
              id="minimo"
              formControlName="precioMinimo"
              class="form-control"
              placeholder="$3000"
            />
          </div>
          <div>
            <label for="maximo" class="mb-1">Maximo</label>
            <input
              type="number"
              id="maximo"
              formControlName="precioMaximo"
              class="form-control"
              placeholder="$20000"
            />
          </div>
        </div>
      </div>
    </form>
  </aside>

  <section class="flex-grow-1">
    @if (errorMessage) {
    <div class="alert alert-danger text-center my-3" role="alert">
      <strong>Error:</strong> {{ errorMessage }}
    </div>
    }

    <div class="grid-libros">
      @if (books.length === 0 && !errorMessage) {
      <p class="text-center">No se encontraron libros</p>
      } @for (book of books; track book.id) {
      <article class="libro">
        <div class="informacion" [routerLink]="['/detalle', book.id]">
          <img [src]="book.ruta_imagen" class="portada" [alt]="'Portada de ' + book.titulo" />
          <h3 class="titulo-libro">{{ book.titulo }}</h3>
          <h4 class="autor-libro">{{ book.autor }}</h4>

          <div class="mb-3">
            <p class="m-0">{{ book.genero }}</p>
            <strong>{{ book.formato }}</strong>
          </div>
        </div>

        <div class="precio">
          <b>${{ book.precio | number }}</b>
          <button class="cta-button">Agregar al Carrito</button>
        </div>
      </article>
      }
    </div>
  </section>
</div>
